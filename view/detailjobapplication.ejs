<% layout("layout") %>

<div class="container mt-4">
    <div class="card shadow-sm border-light">
        <div class="card-header bg-white pb-0 border-0">
            <h2 class="card-title h3">Software Engineer @ <%= job.companyName %></h2>
        </div>
        <div class="card-body">
            <!-- Top Details Section -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <p><i class="bi bi-building text-primary me-2"></i><strong>Company:</strong> <%= job.companyName %></p>
                    <p><i class="bi bi-geo-alt-fill text-danger me-2"></i><strong>Location:</strong> <%= job.location %></p>
                    <p><i class="bi bi-briefcase-fill text-success me-2"></i><strong>Package:</strong> <%= job.package %></p>
                </div>
                <div class="col-md-6">
                    <p><i class="bi bi-bookmark-star-fill text-info me-2"></i><strong>Eligibility:</strong> <%= job.eligibility.department.join(', ') %>, CGPA <%= job.eligibility.minCgpa %>+</p>
                    <p><i class="bi bi-calendar-event-fill text-warning me-2"></i><strong>Deadline:</strong> <%= new Date(job.deadline).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %></p>
                </div>
            </div>

            <!-- Accordion for Details -->
            <div class="accordion" id="jobDetailsAccordion">
                <!-- Overview -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            <i class="bi bi-card-text me-2"></i> Overview
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#jobDetailsAccordion">
                        <div class="accordion-body">
                            <%= job.overview %>
                        </div>
                    </div>
                </div>
                <!-- Skills & Eligibility -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                           <i class="bi bi-person-check-fill me-2"></i> Skills & Eligibility
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#jobDetailsAccordion">
                        <div class="accordion-body">
                            <strong>Skills:</strong> <%= job.skills.join(', ') %><br>
                            <strong>Eligibility:</strong> <%= job.eligibility.department.join(', ') %>, CGPA <%= job.eligibility.minCgpa %>+
                        </div>
                    </div>
                </div>
                <!-- Compensation -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            <i class="bi bi-cash-coin me-2"></i> Compensation
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#jobDetailsAccordion">
                        <div class="accordion-body">
                            <strong>Fixed:</strong> <%= job.compensation.fixed %> LPA<br>
                            <strong>Variable:</strong> <%= job.compensation.variable %> LPA<br>
                            <strong>Other Benefits:</strong> <%= job.compensation.otherBenefits %>
                        </div>
                    </div>
                </div>
                 <!-- Timeline -->
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                             <i class="bi bi-calendar3-range me-2"></i> Timeline
                        </button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#jobDetailsAccordion">
                        <div class="accordion-body">
                           <strong>Online Test:</strong> <%= new Date(job.timeline.testDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %><br>
                           <strong>Interview:</strong> <%= new Date(job.timeline.interviewDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %><br>
                           <strong>Final Offer:</strong> <%= new Date(job.timeline.offerDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer bg-white d-flex justify-content-end gap-2">
             <a href="/jobs" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Back to Jobs</a>
             <a href="/jobs/<%= job._id %>/apply" class="btn btn-primary flex-fill">Apply Now</a>
        </div>
    </div>
</div>
